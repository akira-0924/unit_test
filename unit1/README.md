# 第一部 単体テストとは

## 「単体テストを書くことによって設計がより優れたものになる」はあくまで副産物であり、第一の目標ではない

第一の目標は、**ソフトウェア開発プロジェクトの成長を持続可能なものにする**ということ

- **すべてのテストケースは平等に作られているわけではない**

  - 単にテストケースを増やしただけでは単体テストの目標を実現できるわけではない
  - 作成する単体テストの価値とその維持にかかるコストの両方を考慮しなければならない

### コード網羅率 (code coverage)

- テストケースがテスト対象のコードを網羅しているかどうかを測る指標
- コードの行数で測る

### 分岐網羅率 (branch coverage)

- テストケースがテスト対象のコードの分岐を網羅しているかどうかを測る指標
- コードの行数ではなく、分岐の数で測る

**↑ のどちらの計測を行なったとしても、網羅率を使ってテスト・スイートの質を評価することはできない（以下）**

- 網羅率からは実際にテスト対象のコードが検証されたのかを保証できない
  - テスト対象のコードによって生み出された結果が想定していた結果と一致することを確かめる必要がある
- 網羅率を算出する際、使用するライブラリ内のコードは計測の対象からは外されるため
  - ライブラリ内のコードはテスト対象のコードではないため、網羅率を算出する際には除外される

**よって網羅率の数値を目標とするような使い方をせず、テストが十分に行われていないことを示すものとして使うべき**

## 自分的まとめ

網羅率は高い数値を目標とするが、数値が高いからといって必ずしもテストが十分に行われているとは限らない。ただ、数値が低い場合はテストが十分に行われていないことが確かなため、あくまでテストが十分に行われていないことを示すものとして使うべき。

## 何がテスト・スイートの質を良くするのか

結局、各テストケースを 1 つずつ評価することしかない

### 優れたテスト・スイートの特徴

- テストをすることが開発サイクルに組み込まれている
- コードベースの特に重要な部分のみがテスト対象となっている
  - ビジネスロジックつまりドメイン・モデル
- 最小限の保守コストで最大限の価値を生み出すようになっておる
