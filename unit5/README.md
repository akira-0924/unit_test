# モックの利用とテストの壊れやすさ

## モックとスタブの違い

- モック
  - テスト対象システムとその協力者オブジェクトとのやり取りを検証するのに使われるテスト・ダブルのこと。そしてテスト・ダブルにはモックとは別の種類のスタブと呼ばれるものがある。

### テスト・ダブルの種類

テスト・ダブルとは、プロダクションコードには含まれず、テストでしか使われない偽りの依存として表現される全てのものを包括的に意味するもの。

**ダミー、スタブ、スパイ、モック、フェイク**の 5 種類があるが、モック(モック、スパイ)、スタブ(ダミー、スタブ、フェイク)の 2 つに分けることができる。

- モックはテスト対象システムからその依存に向かって行われる**外部に向かう**コニュニケーション(出力)を模倣し、検証するのに使われる。このときモックが模倣するコミュニケーションはテスト対象システムが依存の状態を変えるために行う依存への呼び出しのことになる。
- スタブは依存からテスト対象システムに向かって行われる**内部に向かう**コミュニケーション(入力)を模倣するのに使われる。このときスタブが模倣するコミュニケーションはテスト対象システムが依存からデータを取得するために行うその依存への呼び出しのことになる。

**スタブとのやり取りを決して検証してはならない**
テスト対象のシステムが行うスタブへの呼び出しは、テスト対象システムが生み出す最終的な結果の一部ではなく、その最終的な結果を生み出す一過程にすぎないからである。
